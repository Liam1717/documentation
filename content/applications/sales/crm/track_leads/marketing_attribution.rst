=============================
Marketing attribution reports
=============================

Use the Odoo *CRM* app to compile a *marketing attribution report*, which analyzes the source of
leads in the CRM, and groups them in such a way as to calculate marketing's overall impact on lead
generation, attribution, won rate, and more.

Leads Analysis dashboard
========================

Begin by navigating to the :guilabel:`Leads Analysis` dashboard by going to :menuselection:`CRM app
--> Reporting --> Leads`.

.. tip::
   Alternatively, reports can also be run on the :menuselection:`CRM app --> Leads` dashboard or the
   :menuselection:`CRM app --> Sales --> My Pipeline` dashboard (in case the :guilabel:`Leads`
   dashboard is not available); both dashboards contain the necessary :guilabel:`Filters` and
   :guilabel:`Group By` criteria to run an attribution report.

.. seealso::
   - :doc:`Convert leads into opportunities <../acquire_leads/convert>`
   - :doc:`Create leads <../acquire_leads/email_manual>`

.. image:: marketing_attribution/reporting-tab-and-leads.png
   :align: center
   :alt: Open the CRM app and click on the Reporting tab at the top of the page, then click Leads.

The :icon:`fa-area-chart` :guilabel:`(Graph)` view will be shown by default, with :guilabel:`Active
or Inactive` and :guilabel:`Created on: YYYY` filters active in the :guilabel:`Search...` bar. The
graph visualization displays the number of leads generated, by month and by sales team, with each
sales team attributed to its own color per bar (month) shown.

Switch the view to the :icon:`oi-view-list` :guilabel:`(List)` option, by clicking the respective
icon located at the top-right of the dashboard.

.. image:: marketing_attribution/list-view-button.png
   :align: center
   :alt: Click the button with four horizontal lines on the top right of the Leads Analysis page.

Add UTM parameters
==================

*Urchin Tracking Modules (UTMs)* are snippets of text embedded in URLs that allow for data about
visitors to be tracked. This includes parameters relating to how a visitor reached the link, such as
the type of website visited and marketing campaign the visit came from.

Odoo can use these UTMs as parameters in the marketing attribution report to track the metrics and
performance of marketing campaigns.

Create UTMs
-----------

The :doc:`link tracker <../../../websites/website/reporting/link_tracker>` in Odoo can be used to
create and configure UTMs.

UTMs can also be automatically generated by :doc:`Email Marketing
<../../../marketing/email_marketing>` and :doc:`Marketing Automation
<../../../marketing/marketing_automation>` apps.

The UTM parameters used in a marketing attribution report are *Medium*, *Source*, and *Campaign* in
descending order of coverage.

- *Medium* is the UTM with the widest coverage, such as social media.
- *Source* is more narrow and covers parameters such as the specific social media platform.
- *Campaign* is the narrowest and can track specific marketing campaigns.

Create reports
==============

To start creating a report, click the :icon:`fa-caret-down` :guilabel:`(down caret)` to the right of
the search bar to see the list of filtering and grouping parameters.

:guilabel:`Filters`, located in the left column of the search options, can be used to keep only
the results that fit the filter. For example, selecting the :guilabel:`Won` filter will only
show won leads in the attribution report. :guilabel:`Group By`, found in the middle column, is
used to organize the results into groups and can be used with or without filters.

.. image:: marketing_attribution/search-results-multiple-options.png
   :align: center
   :alt: Select any number of filters and groups in the search options.

.. tip::
    Setting multiple Group By options will create nested groups according to which is selected
    first. For example, selecting :guilabel:`Medium` followed by :guilabel:`Source` and then
    ::guilabel:`Campaign` in :guilabel:`Group By` will sort all results *first* by medium, *then* by
    the specific sources in each medium, followed by the campaigns in each source.

    This can be verified by looking at the direction of the carat in the group tile in
    the search bar.

    .. image:: marketing_attribution/group-by.png
       :align: center
       :alt: The text in the tile is `Country > City`, showing that city is a subgroup of country.

.. example::
    For a useful first report:

    #. Select the :guilabel:`Active` filter to view only leads that are still marked as active.
    #. Select :guilabel:`Source` followed by the :guilabel:`City` or :guilabel:`Country`
       groups depending on which grouping is more relevant.

    .. image:: marketing_attribution/campaign-and-country-groups.png
       :align: center
       :alt: Each lead is now sorted by source, followed by city or country.

    This report will contain all active leads grouped first by the source of the lead, then the
    country or city each lead is from. This is useful to see the density of active opportunities
    sorted by location.

    With this data, marketing campaigns such as conferences or billboards can be targeted to the
    locations generating the largest amount of potential revenue. Similarly, more attention can be
    put toward increasing outreach in locations where existing marketing campaigns are less
    effective.

Export reports
==============

To set measures of the report, begin by navigating to the :icon:`oi-view-pivot`
:guilabel:`(pivot view)`. Click the :guilabel:`Measures` button to view the available measures of
the report. Select the desired measures, and verify the measures, filters, and groups are all
displayed correctly in the pivot table.

Next, click on the :icon:`fa-cog` :guilabel:`(settings)` button to
the right of :guilabel:`Lead Analysis` in the top-left of the page to view the available export
options.

To export the report in the Odoo *Documents* app, navigate to :menuselection:`Settings app -->
Spreadsheet --> Insert list in spreadsheet`. A menu will appear with export options.

The report can be named using the `Name of the list` field. The number of items on the report can be
set with the field labeled: `Insert the first _ records of the list`. Next, select either a new
blank spreadsheet, or export into an existing spreadsheet Finally, click the :guilabel:`Confirm`
button.

.. image:: marketing_attribution/documents-export.png
   :align: center
   :alt: Set the name, number of records, and location of the export in the option menu.

To export the report as a \*.xlsx file for use in an external spreadsheets program, navigate to
:menuselection:`Settings app` and click the :icon:`fa-upload` :guilabel:`(Export All)` button. If
prompted, choose a file location and a name for the file, then click :guilabel:`Save`.
